{"icon":"other","splash":"other","splashdata":{"img":"carillion_master_lock_up_colour.png","bg":"#ffffff"},"settings":{"router":{"mode":"single","animation":"off"},"theme":"default","push-notifications":{"android":{"enabled":false},"ios":{"enabled":false}},"provisioning":{"enabled":false,"manifest":"","poll":2,"manual":false,"wifionly":true},"loading-message":true,"logging":{"enabled":false,"bufferFrequency":100,"defaultRootLogLevel":"error","defaultMaxFileSizeKilobyte":1000,"defaultMaxFiles":5,"appEnabled":true,"appUseDefault":true,"appRootLogLevel":"error","appMaxFileSizeKilobyte":1000,"appMaxFiles":5,"clientEnabled":true,"clientUseDefault":true,"clientRootLogLevel":"error","clientMaxFileSizeKilobyte":1000,"clientMaxFiles":5,"nativeEnabled":true,"nativeUseDefault":true,"nativeRootLogLevel":"error","nativeMaxFileSizeKilobyte":1000,"nativeMaxFiles":5},"plugins":{"builtIn":{"cordova-plugin-whitelist@1.2.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-battery-status@1.1.2":{"override":false,"used":false,"enabled":false},"cordova-plugin-console@1.0.3":{"override":false,"used":true,"enabled":true},"cordova-plugin-contacts@2.1.0":{"override":false,"used":false,"enabled":false},"cordova-plugin-device@1.1.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-device-motion@1.2.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-device-orientation@1.0.3":{"override":false,"used":false,"enabled":false},"cordova-plugin-file@4.2.0":{"override":false,"used":true,"enabled":true},"cordova-plugin-geolocation@2.2.0":{"override":true,"used":false,"enabled":true},"cordova-plugin-globalization@1.0.3":{"override":false,"used":true,"enabled":true},"commontime-cordova-plugin-inappbrowser@1.6.2":{"override":false,"used":false,"enabled":false},"cordova-plugin-network-information@1.2.1":{"override":true,"used":false,"enabled":true},"cordova-plugin-splashscreen@3.2.2":{"override":false,"used":true,"enabled":true},"cordova-plugin-vibration@2.1.1":{"override":false,"used":false,"enabled":false},"cordova-plugin-statusbar@1.0.1":{"override":false,"used":true,"enabled":true},"cordova-plugin-camera@2.3.1":{"override":false,"used":true,"enabled":true},"phonegap-plugin-barcodescanner@6.0.4":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.thumbnail@1.4.8":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.fileimporter@1.0.0":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.beacon@1.0.6":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.notification@1.0.11":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.audio@0.9.10":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.media-properties@1.2.11":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.splitscreen@1.1.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.preferences@1.0.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.authentication@1.0.8":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.urlhandler@1.1.0":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.securesettings@1.0.2":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.geofence@0.5.0":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.file-transfer@1.5.5":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.public.provisioning@0.0.13":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.insomnia@0.0.6":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.splunk-mint@1.0.3":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.kiosk@1.0.11":{"override":false,"used":false,"enabled":false},"cordova-android-movetasktoback@0.1.3":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.logging@1.0.20":{"override":false,"used":true,"enabled":true},"cordova-plugin-email-composer":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.public.messaging@0.0.38":{"override":false,"used":true,"enabled":true},"cordova-plugin-battery-status@1.2.4":{"override":false,"used":false,"enabled":false},"cordova-plugin-vibration@2.1.4":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.file-opener@1.0.11":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.notification@1.0.12":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.audio@0.9.11":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.insomnia@0.0.15":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.logging@1.0.24":{"override":false,"used":true,"enabled":true},"cordova-plugin-email":{"override":false,"used":true,"enabled":true},"cordova-android-crosswalk-webview@2.3.0":{"override":false,"enabled":false},"cordova-plugin-emm-app-config@1.0.0":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.public.messaging@0.0.42":{"override":false,"used":true,"enabled":true},"com.commontime.cordova.file-opener@1.0.8":{"override":false,"used":false,"enabled":false},"com.commontime.cordova.public.messaging@0.0.44":{"override":false,"used":true,"enabled":true}},"customPlugins":{}}},"language":{"defaultLocale":"en_GB","initialLanguage":"","useDeviceLocale":true},"metadata":{"googleMapsApiKey":"AIzaSyDkfTdp3-BMFkiFaEr_cQskrl6AGERLYR8"},"name":"DWBLite","version":"1.2.3","schemaVersion":22,"pages":[{"start":true,"name":"SelectSite","config":[{"name":"Page Load Event","type":"event","item-type":"onload","_auto_id_":"83cb1022-f399-47e7-bdf9-6957cf7261b5","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"var timer;\nvar touchDuration = 2000;\n\nfunction touchStart() {\n\ttimer = setTimeout(onlongTouch, touchDuration);\n}\n\nfunction touchEnd() {\n\tif(timer) {\n      clearTimeout(timer);  \n    }\n}\n\nfunction onlongTouch() {\n  cti.utils.callAction('go-to-page', { name: 'DWBList' }); \n}\n\nif(cti.store.variables.firstLoad === undefined) {\n  cti.store.variables.firstLoad = true;\n}\n\nif(cti.store.variables.firstLoad) {\n  cti.utils.callAction('go-to-page', { name: 'YourDetails' }); \n} else {\n  setTimeout(function() {\n    var title = document.getElementById('title');\n    title.removeEventListener('touchstart', touchStart);\n    title.removeEventListener('touchend', touchEnd);\n    title.addEventListener('touchstart', touchStart);\n    title.addEventListener('touchend', touchEnd);\n\n    window.commsManager = new CommsManager();\n\n    var act = document.getElementsByTagName('activity-loader')[0];\n    act.show();\n    act.updateText('Getting GPS...');\n\n    if(cti.store.currentSites !== undefined) {\n      for(var i = 0; i < cti.store.currentSites.length; i++) {\n        delete cti.store.currentSites[i].selected; \n      }\n    }\n\n    cti.utils.callAction('call-actionflow', {\"name\":\"LoadMap\"})\n  }, 250);\n}\n\nthis.$success();"},"_auto_id_":"447b0373-741d-4089-84d2-ce47ce6dd2b0","actions":[]}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnRefresh","type":"button","item-type":"button","_auto_id_":"fe7823f6-5c48-4569-95d4-711799205c46","content":"","theme":"default","left-icon":"fa-refresh","actions":[{"event":"click","type":"call-actionflow","data":{"name":"LoadMap"},"_auto_id_":"81eb5998-6944-4aa6-a129-bd7c7ab3972e"}],"expressions":{},"classes":""},{"name":"title","type":"content","item-type":"title","content":"<h1>Which contract are you at?</h1>","_auto_id_":"54ae5a0a-6b5b-4637-ad30-453dbc8f1873"},{"name":"btnGoToManual","type":"button","item-type":"button","_auto_id_":"877b62b7-be66-43df-8b21-2190683e08dc","content":"","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-component-function","data":{"page":"SelectSite","componentInstanceId":"5223c27c-8885-4c61-a771-6efa2f123da6","function":"togglePopup"},"_auto_id_":"c6838b9f-8574-427d-a18e-11e21ad8f7cd"}],"left-icon":"fa-info-circle"}],"_auto_id_":"01e8dcc7-9351-4204-b088-0d5d9574b310"},{"name":"staticMap","type":"area","item-type":"static","_auto_id_":"d20dcee4-8be7-4894-a9b9-3bc8a48a46bd","content":[{"name":"htmlMap","type":"content","item-type":"html","_auto_id_":"fc2bb9e8-14df-4bac-976d-256ec05a9b5e","content":"<div id=\"map\"></div>","expressions":{}}],"expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"lstSites","type":"content","item-type":"list","_auto_id_":"f1473a95-d4a9-4cdb-bb49-789cd80542f5","search":"","classes":"","content":[{"type":"content","item-type":"html","name":"lstSites_html","_auto_id_":"bf417ba0-b35f-4b2d-9e3e-afea57f15057","content":"<div class=\"listView {{$data.$item.selected ? 'selected' : ''}}\">\n  <p>{{$data.$item.counter}}. {{$data.$item.SiteName}}</p>\n</div>"}],"model":"$store.currentSitesOnMap","actions":[{"event":"click","type":"call-function","data":{"name":"chooseSiteFromList","params":{"siteName":"{{$data.$item.SiteName}}","site":"{{$data.$item}}"}},"_auto_id_":"d7f52e4c-e03d-4952-9849-738b1799271b"}],"expressions":{},"dataSource":"dynamic","data":"","listItemClasses":""}],"_auto_id_":"dbbb73b1-e2ae-47cf-8f1e-e92677aa290a","expressions":{}},{"name":"nav_footer","type":"area","item-type":"button-bar","_auto_id_":"5e4c82ac-e589-492d-b113-6117e8800108","content":[{"name":"btnSiteNotListed","type":"button","item-type":"button","_auto_id_":"d2ae77a4-e499-439a-91f2-9a4e056e9756","content":"My Contract Isn't Listed","theme":"default","actions":[{"event":"click","type":"go-to-page","data":{"name":"SelectSiteManual","isConditional":false},"_auto_id_":"8f5f415b-5f5c-4f63-854e-c614db3ba410"}],"expressions":{}},{"name":"btnNext","type":"button","item-type":"button","_auto_id_":"22220bca-ba94-4ae2-9488-289b536e8e22","content":"Next","theme":"default","actions":[{"event":"click","type":"go-to-page","data":{"name":"ReportIncident","isConditional":false},"_auto_id_":"98c196ef-f8f0-4071-b63a-4fff98f07ac9"}],"expressions":{"show":"$store.selectedLocation !== undefined"}}],"extends":{"type":"area","item-type":"row"},"expressions":{}},{"name":"static_1","type":"area","item-type":"static","_auto_id_":"41eefc82-9660-4ba0-a59d-ace6c212b936","content":[{"name":"ldrMap","type":"component","item-type":"web-component","content":[],"_auto_id_":"600f834b-9f1b-424f-b146-92d6370ad1ef","attributes":{},"expressions":{},"componentId":"0e9b4cd0-3972-45ca-a2dc-0e1073bb1625","actions":[]},{"name":"popTelentSiteSelected","type":"component","item-type":"web-component","content":[{"name":"htmlTelentOrderNo","type":"content","item-type":"html","_auto_id_":"7051e127-72bd-4cc2-8d0a-6b8e89de2309","content":"<p>Please enter your Carillion Telent Order number:</p>","expressions":{}},{"name":"txtTelentOrderNo","type":"user-input","item-type":"text","_auto_id_":"62b3125b-d484-40d7-a7bd-932ce2571704","label":"","required":false,"multiline":false,"debounce":250,"validators":[{"name":"matches10Numbers","type":"regex","content":"[0-9]{10}","message":"Order numbers must be 10 numbers long"}],"actions":[],"expressions":{},"placeholder":"1234567890"},{"name":"btnOkayTelent","type":"button","item-type":"button","_auto_id_":"e8c4f93b-33e0-494c-8b3d-0d5049d10a40","content":"Okay","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var orderNo = cti.store.pages.SelectSite.txtTelentOrderNo;\nvar pattern = new RegExp(\"[0-9]{10}\");\n\nif(pattern.test(orderNo)) {\n  cti.store.invoked = {\n    location: null,\n    name: null,\n    orderNo: parseInt(orderNo),\n    postcode: null,\n    subcontractor: cti.store.selectedLocation.name,\n    timestamp: new Date().getTime(),\n    type: \"telent\"\n  }\n\n  cti.togglePopup('popTelentSiteSelected');\n  cti.utils.callAction('go-to-page', 'ReportIncident');\n}"},"_auto_id_":"1d6f29d1-7bb9-43df-81bf-9c171739fb30"}],"left-icon":"fa-check"},{"name":"btnCancelTelent","type":"button","item-type":"button","_auto_id_":"b0cd3d6f-e498-4c03-8ea0-0882652edb18","content":"Cancel","theme":"default","expressions":{},"classes":"cancel","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.selectedLocation;\ncti.togglePopup('popTelentSiteSelected');"},"_auto_id_":"16746e2e-d1d2-4089-aa27-85f4b5ee8e80"}],"left-icon":"fa-times"}],"componentId":"44b83127-7dde-471d-a00e-44b3c567df90","_auto_id_":"dbf4251c-2f3e-4ab9-a769-7ea5468a4f17","attributes":{"id":"popTelentSiteSelected"},"expressions":{},"actions":[]},{"name":"popErr","type":"component","item-type":"web-component","content":[{"name":"htmlErr","type":"content","item-type":"html","_auto_id_":"dd8588ae-28d4-4be7-b5a2-76a18a0b30a5","content":"<p>There was an error downloading the map information. Please use the refresh icon at the top right to try again or use manual contract selection.</p>","expressions":{}},{"name":"btnManualSite","type":"button","item-type":"button","_auto_id_":"bce25e0f-9ff0-4857-b2a2-74f5293eb9c3","content":"Manual Site Selection","theme":"default","left-icon":"fa-search","actions":[{"event":"click","type":"go-to-page","data":{"name":"SelectSiteManual","isConditional":false},"_auto_id_":"588d17ee-b8df-4ece-8e0d-087995a08d5a"}],"expressions":{},"classes":""},{"name":"btnCancel","type":"button","item-type":"button","_auto_id_":"c4fc9b17-f308-4513-a166-3d8ce85cc25f","content":"Cancel","theme":"default","left-icon":"fa-times","actions":[{"event":"click","type":"call-function","data":{"name":"togglePopup","params":{"popupId":"popErr"}},"_auto_id_":"e42e234f-b194-4ade-8f98-eb72d8ec114c"}],"expressions":{},"classes":"cancel"}],"_auto_id_":"c7989f9b-912a-4fa8-aa2f-4fafec6eafe3","attributes":{"id":"popErr"},"expressions":{},"actions":[],"componentId":"44b83127-7dde-471d-a00e-44b3c567df90"},{"name":"popVersion","type":"component","item-type":"web-component","content":[{"name":"htmlVersion","type":"content","item-type":"html","_auto_id_":"6e729756-7eb0-40ee-812b-b5b9b2f002ba","content":"<p>The current application version is: {{'$store.schema.version' | store}}.</p>","expressions":{}},{"name":"btnVersionOkay","type":"button","item-type":"button","_auto_id_":"228e83df-e519-4f08-9bbe-d06ffa760e6f","content":"Okay","theme":"default","left-icon":"fa-check","actions":[{"event":"click","type":"call-component-function","data":{"page":"SelectSite","componentInstanceId":"5223c27c-8885-4c61-a771-6efa2f123da6","function":"togglePopup"},"_auto_id_":"d2553ff3-e6ee-4dfe-9f35-faa03e6710a3"}],"expressions":{}}],"_auto_id_":"5223c27c-8885-4c61-a771-6efa2f123da6","attributes":{"id":"popVersion"},"expressions":{},"componentId":"44b83127-7dde-471d-a00e-44b3c567df90"},{"name":"popGPSError","type":"component","item-type":"web-component","content":[{"name":"htmlGPSError","type":"content","item-type":"html","_auto_id_":"1d2eae23-6383-4439-a13a-ed80561bdb48","content":"<p>There was an error determining your location. Please use manual contract selection.</p>","expressions":{}},{"name":"btnGPSManual","type":"button","item-type":"button","_auto_id_":"d60c8b98-4b04-4c48-bf95-5394b4f39a16","content":"Manual Site Selection","theme":"default","left-icon":"fa-search","actions":[{"event":"click","type":"go-to-page","data":{"name":"SelectSiteManual","isConditional":false},"_auto_id_":"d7f46f94-4c8d-4e25-83f6-5b2daacc1e0f"}],"expressions":{}}],"_auto_id_":"8163b69d-0377-479d-ae8c-cf0ec2154e7d","attributes":{"id":"popGPSError"},"expressions":{},"componentId":"44b83127-7dde-471d-a00e-44b3c567df90"}]}],"$hover":false},{"name":"SelectSiteManual","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"button","item-type":"button","_auto_id_":"db3e4d35-c85e-4c4f-b312-8316f556f4a3","content":"","theme":"default","left-icon":"fa-arrow-left","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"//delete cti.store.pages.SelectSiteManual.txtSearch;\nthis.$success();"},"_auto_id_":"35dad586-9dd0-401e-a29c-c91c16bba464"},{"event":"click","type":"go-to-page","data":{"name":"SelectSite","isConditional":false},"_auto_id_":"a9b58bdb-461d-4ae6-a9f1-2bf41711902a"}],"expressions":{}},{"name":"title","type":"content","item-type":"title","content":"<h1>Contract Not Listed</h1>","_auto_id_":"7d824a9a-5090-4a0f-ab40-2a74555f2474"},{"name":"btnHidden","type":"button","item-type":"button","_auto_id_":"fca3879a-9479-4257-8868-d4b52023d785","content":"","theme":"default","left-icon":"fa-arrow-left","actions":[],"expressions":{},"classes":"ctHide"}],"_auto_id_":"33a627da-47f6-4274-9753-0dff7d3eda21"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"htmlDescription","type":"content","item-type":"html","_auto_id_":"a653c630-deaf-471f-9b48-40164f704a52","content":"<p>Search all contracts in the UK by typing its name below and selecting from the list that appears.</p>","expressions":{}},{"name":"ctAutoSiteSearch","type":"component","item-type":"web-component","content":[],"_auto_id_":"06924aa5-70f8-43f3-943c-5d10c72db0ee","attributes":{"listSource":"currentSites"},"expressions":{},"actions":[],"componentId":"a5471e48-8588-4587-8105-51e434127585"}],"_auto_id_":"6bf7d665-805a-4a2f-a776-fb2eba4e6395"},{"name":"nav_footer","type":"area","item-type":"button-bar","_auto_id_":"d4521c95-2e9a-4a3c-9678-bac0a9bca6e9","content":[{"name":"btnNext","type":"button","item-type":"button","_auto_id_":"089c1915-daeb-4b57-bd86-d54cb6c3864d","content":"Next","theme":"default","expressions":{"show":"1 == 2"},"actions":[{"event":"click","type":"go-to-page","data":{"name":"ReportIncident","isConditional":false},"_auto_id_":"4b5c3ff5-6be0-4d3e-b775-46dd56076fa3"}]}],"extends":{"type":"area","item-type":"row"},"expressions":{}},{"name":"staticContainer","type":"area","item-type":"static","_auto_id_":"e5b4c98e-c365-4a3b-b6f6-46f1144f8c1f","content":[{"name":"popTelentSiteSelected","type":"component","item-type":"web-component","content":[{"name":"htmlTelentOrderNo","type":"content","item-type":"html","_auto_id_":"666577af-c90e-43b8-ae9e-79a261ae627a","content":"<p>Please enter your Carillion Telent Order number:</p>","expressions":{}},{"name":"txtTelentOrderNo","type":"user-input","item-type":"text","_auto_id_":"d49ed820-0db7-4c8d-977a-48c123baa795","label":"","required":false,"multiline":false,"debounce":250,"expressions":{},"placeholder":"1234567890","validators":[{"message":"Order numbers must be 10 numbers long","name":"matches10Numbers","type":"regex","content":"[0-9]{10}"}]},{"name":"btnOkayTelent","type":"button","item-type":"button","_auto_id_":"0cfa393e-2920-49ee-9c93-996d5e3f5b55","content":"Okay","theme":"default","expressions":{},"left-icon":"fa-check","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var orderNo = cti.store.pages.SelectSite.txtTelentOrderNo;\nvar pattern = new RegExp(\"[0-9]{10}\");\n\nif(pattern.test(orderNo)) {\n  cti.store.invoked = {\n    location: null,\n    name: null,\n    orderNo: parseInt(orderNo),\n    postcode: null,\n    subcontractor: cti.store.selectedLocation.name,\n    timestamp: new Date().getTime(),\n    type: \"telent\"\n  }\n\n  cti.togglePopup('popTelentSiteSelected');\n  cti.utils.callAction('go-to-page', 'ReportIncident');\n}"},"_auto_id_":"bdc64a33-ac60-4c3b-9d0f-1ec2abdf2ae9"}]},{"name":"btnCancelTelent","type":"button","item-type":"button","_auto_id_":"151a5a6d-4479-464a-a01b-cd5141ac31e2","content":"Cancel","theme":"default","expressions":{},"left-icon":"fa-times","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.selectedLocation;\ncti.togglePopup('popTelentSiteSelected');"},"_auto_id_":"7685e8ac-9750-4e17-bdf8-9e15fcc9beab"}],"classes":"cancel"}],"componentId":"44b83127-7dde-471d-a00e-44b3c567df90","_auto_id_":"49321474-3f5a-41b1-818d-0ddf45d2c45d","attributes":{"id":"popTelentSiteSelected"},"expressions":{}}],"expressions":{}}],"$hover":false},{"name":"ReportIncident","config":[{"name":"Page Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"b3d201c4-168a-41c5-8563-93fb59efe846","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"console.log('Report Incident page loaded');\n\n$success();"},"_auto_id_":"b8845254-4ffb-4a6b-a265-c55c5be8f583"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"button","item-type":"button","_auto_id_":"2f47aa8e-91d7-4144-b922-ed8b034877b6","content":"","theme":"default","left-icon":"fa-arrow-left","actions":[{"event":"click","type":"go-to-page","data":{"name":"SelectSite","isConditional":false},"_auto_id_":"af21c4ea-0ea3-43c4-a829-e0f11c1257f2"}],"expressions":{}},{"name":"title","type":"content","item-type":"title","content":"<h1>Report</h1>","_auto_id_":"c6b90d9f-2e28-4bce-b789-d7bcf020c1ea"},{"name":"btnHidden","type":"button","item-type":"button","_auto_id_":"89737194-6953-48c0-a1fb-143e2dbd3a09","content":"","theme":"default","left-icon":"fa-arrow-left","actions":[],"expressions":{},"classes":"ctHide"}],"_auto_id_":"79d7659d-dcb7-422b-b986-c0f328d19378"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"txtWhat","type":"user-input","item-type":"text","_auto_id_":"29af0c37-d429-48f8-bde2-5b727ea6acd1","label":"What do you want to tell us?","required":true,"multiline":true,"debounce":250,"message":"This is a required field","validators":[],"actions":[],"expressions":{},"description":""},{"name":"txtActions","type":"user-input","item-type":"text","_auto_id_":"c24017a7-088f-49ec-9751-fc121ee628c5","label":"Describe any actions you have taken (leave blank if you have been unable to take action)","required":false,"multiline":true,"debounce":250,"message":"This is a required field","expressions":{},"validators":[],"actions":[]},{"name":"txtLocation","type":"user-input","item-type":"text","_auto_id_":"b78ee50e-af68-4af6-92ee-3544d757589b","label":"Location of the Issue (i.e. Floor, Level, Marker Post, Room or Chainage)","required":false,"multiline":true,"debounce":250,"message":"This is a required field","expressions":{},"validators":[],"actions":[]},{"name":"tpDwbPhoto","type":"capture","item-type":"take-photo","_auto_id_":"2f541957-58ae-4b37-b861-42e06660448a","label":"Take Photo: ","required":false,"extends":{"type":"area","item-type":"group"},"content":[{"name":"dwbPhoto","type":"button","item-type":"take-photo-button","_auto_id_":"6ae7c4c0-c2c0-45ce-be8c-0025e812806f","extends":{"type":"button","item-type":"button"},"content":"Take photo","actions":[{"event":"click","type":"take-photo","data":{"quality":40,"multiple":true,"mediaId":"sendDwbPhoto"}}],"left-icon":"fa-camera","theme":"default","expressions":{}},{"name":"image_1","type":"media","item-type":"image-viewer","_auto_id_":"a78c5656-9720-4570-be44-8e9d28a587b2","scaleImage":true,"maxWidth":200,"maxHeight":200,"model":"$store.media.sendDwbPhoto.images","actions":[],"expressions":{}}],"expressions":{}},{"name":"rdoFurtherAction","type":"choice","item-type":"radio","_auto_id_":"4fb06f4f-3a33-4810-a6ec-3ac69ddcd263","label":"Does this still require further action by us?","required":false,"options":[{"label":"Yes","value":"true"},{"label":"No","value":"false"}],"expressions":{"default":"\"false\""}},{"name":"rdoScale","type":"choice","item-type":"radio","_auto_id_":"f87c553d-ad31-4766-9340-e285737b1f6a","label":"How serious would you consider this issue?","required":false,"options":[{"label":"Minor","value":1},{"label":"Significant","value":2},{"label":"Serious","value":3},{"label":"Life Threatening","value":"4"}],"expressions":{"default":"1"}},{"name":"drpCategory","type":"choice","item-type":"select","_auto_id_":"99cf1baf-9bec-4f26-848f-c6a2cd359a30","label":"Which of these categories does it fall into?","required":true,"options":[{"label":"People falling from height","value":"Falls"},{"label":"Objects falling from height","value":"Objects"},{"label":"Electricity","value":"Electricity"},{"label":"Fire / Explosion","value":"Fire / Explosion"},{"label":"Crushing","value":"Crushing"},{"label":"Health","value":"Health"},{"label":"Environment","value":"Environment"},{"label":"Quality","value":"Quality"},{"label":"Other","value":"Other"},{"label":"Good Ideas","value":"Good Ideas"}],"searchable":false,"message":"This is a required field","validators":[],"expressions":{}},{"name":"chkIncludeDetails","type":"choice","item-type":"checkbox","_auto_id_":"d885a99c-bda6-4308-97b9-48d3231f308c","label":"","required":false,"options":[{"label":"Include contact details","id":"includeDetails"}],"icon-selected":"fa-check-square","icon-unselected":"fa-square","expressions":{"default":"{\"includeDetails\":true}"},"validators":[],"actions":[]},{"name":"btnPrivacy","type":"button","item-type":"button","_auto_id_":"0a398d13-ad78-4661-ad40-cb7d2070a2a1","content":"Privacy Policy","theme":"default","expressions":{},"actions":[{"event":"click","type":"go-to-page","data":{"name":"PrivacyInformation","isConditional":false},"_auto_id_":"ba9eb3dc-06c0-4ee6-8367-932f8959b689"}]},{"name":"btnEditDetails","type":"button","item-type":"button","_auto_id_":"7d72b193-f1ca-45f7-b52a-b02a7bfe6a60","content":"Edit Details","theme":"default","expressions":{},"actions":[{"event":"click","type":"go-to-page","data":{"name":"YourDetails","isConditional":false},"_auto_id_":"5a16c8cc-eec0-457b-8614-dc54713ba310"}]},{"name":"htmlAnotherIssue","type":"content","item-type":"html","_auto_id_":"dd29ed47-41c6-4236-8f07-255ad1d2f877","content":"<p>Is there another issue you want to report?</p>","expressions":{}},{"name":"btnAnotherYes","type":"button","item-type":"button","_auto_id_":"ab507373-b07c-48f6-9fc2-bc34dd794ec0","content":"Yes","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-function","data":{"name":"completeReport","params":{"addAnother":"{{true}}"}},"_auto_id_":"933fcf47-45fc-47f7-b7d6-8c3f4fab9987"}]},{"name":"btnAnotherNo","type":"button","item-type":"button","_auto_id_":"8667b151-ecb0-4efa-8183-59c011a1d7b2","content":"No","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-function","data":{"name":"completeReport","params":{"addAnother":"{{false}}"}},"_auto_id_":"1345c48b-bac5-49e9-928f-bdef78b43af3"}]},{"name":"popCreateAnother","type":"component","item-type":"web-component","content":[{"name":"htmlCreateAnother","type":"content","item-type":"html","_auto_id_":"08c92a28-c0ce-483e-b57e-f7319384812e","content":"<p>Thank you for your report. You have indicated that you would like to report another issue. Please select:</p>","expressions":{}},{"name":"btnReportAnother","type":"button","item-type":"button","_auto_id_":"eaebd1c7-50a8-4b58-bab8-018b9c4eb9e5","content":"Report Another Issue","theme":"default","left-icon":"fa-plus","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.pages.ReportIncident;\ndelete cti.store.media.sendDwbPhoto;\ndocument.getElementById('scrollable').scrollTop = 0;\nthis.$success();"},"_auto_id_":"437582c7-eafa-4fca-9fdb-b924f803e390"},{"event":"click","type":"call-function","data":{"name":"togglePopup","params":{"popupId":"popCreateAnother"}},"_auto_id_":"9ce3d299-66ee-413c-a145-f042540b3fca"}]},{"name":"btnProceed","type":"button","item-type":"button","_auto_id_":"eb77754b-3f0a-459c-bf3d-50a15cf0af92","content":"Do Not Report and Proceed","theme":"default","expressions":{},"classes":"cancel","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.pages.ReportIncident;\n\nvar lastReport = cti.store.pendingDwbSubmissions[cti.store.pendingDwbSubmissions.length - 1];\n\nif(lastReport.rdoScale !== '4') {\n  cti.addDwbToQueueAndProcess(false);\n  cti.utils.callAction('go-to-page', 'DetailsSuccess');\n}\nelse {\n  cti.utils.callAction('go-to-page', 'Success');\n}"},"_auto_id_":"3648845e-c2e7-4fbd-954e-365170fc65c6"}],"left-icon":"fa-check"}],"_auto_id_":"e8006dd9-aa9b-4c39-8872-1eb83b27f337","attributes":{"id":"popCreateAnother"},"expressions":{},"componentId":"44b83127-7dde-471d-a00e-44b3c567df90","actions":[]}],"_auto_id_":"15a10455-2cd4-42d1-b3a7-9261625d7a93"},{"name":"staticContainer","type":"area","item-type":"static","_auto_id_":"e6110d5f-7916-4e92-8f3d-29abce191811","content":[{"name":"popFormErrors","type":"component","item-type":"web-component","content":[{"name":"htmlFormErrors","type":"content","item-type":"html","_auto_id_":"4a6fc57a-8794-4177-a1c5-ca722a65749d","content":"<p>Form validation error. Please correct the following fields:</p>","expressions":{}},{"name":"lstSubmissionErrors","type":"content","item-type":"list","_auto_id_":"d4d92080-4eea-4384-9644-6e4652a36bb5","search":"","classes":"","content":[{"type":"content","item-type":"html","name":"lstSubmissionErrors_html","_auto_id_":"46e4894c-c5b5-488f-8d50-40b090aeaf30","content":"<p>{{$data.$item}}</p>","expressions":{}}],"model":"$store.submissionErrors","expressions":{},"dataSource":"dynamic","data":"[]","listItemClasses":""},{"name":"btnFormErrorsOkay","type":"button","item-type":"button","_auto_id_":"8b69470e-e515-4414-b93d-92baafe5f135","content":"Okay","theme":"default","left-icon":"fa-check","actions":[{"event":"click","type":"call-function","data":{"name":"togglePopup","params":{"popupId":"popFormErrors"}},"_auto_id_":"e591dd69-c0b5-4680-97e1-0472a28ed220"}],"expressions":{}}],"_auto_id_":"74044a2a-e3b8-4f59-905f-e13c3232fb52","attributes":{"id":"popFormErrors"},"expressions":{},"actions":[],"componentId":"44b83127-7dde-471d-a00e-44b3c567df90"}],"expressions":{}}],"$hover":false},{"name":"YourDetails","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"button","item-type":"button","_auto_id_":"f30ed5ed-9b22-4695-9d8a-6d7a9631e9c1","content":"","theme":"default","left-icon":"fa-arrow-left","actions":[{"event":"click","type":"go-to-page","data":{"name":"ReportIncident","isConditional":false},"_auto_id_":"d7ac12f0-283c-44cb-a751-7d449c85d638"}],"expressions":{"show":"$store.variables.firstLoad == false"}},{"name":"title","type":"content","item-type":"title","content":"<h1>Your Details</h1>","_auto_id_":"93425f64-2fec-46d8-83d2-f608860415ea"},{"name":"btnHidden","type":"button","item-type":"button","_auto_id_":"b2f77472-f029-4365-9cde-cec25ef0021a","content":"","theme":"default","left-icon":"fa-arrow-left","expressions":{},"classes":"ctHide"}],"_auto_id_":"b6fa5586-42e1-4fa9-9a50-a86e54024003"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"htmlDescription","type":"content","item-type":"html","_auto_id_":"b5d5d5e8-7d8b-43af-b5f4-3ef2176d38fa","content":"<p>Please enter your phone number and/or email. We will notify you when we've dealt with your issue.</p>","expressions":{}},{"name":"txtName","type":"user-input","item-type":"text","_auto_id_":"efb6f60d-e9a1-467f-8418-229ba1666367","label":"Your name (optional):","required":false,"multiline":false,"debounce":250,"validators":[],"actions":[],"expressions":{}},{"name":"txtPhone","type":"user-input","item-type":"text","_auto_id_":"122ea54d-8688-464c-a48c-29ad0264ff0f","label":"Phone number","required":false,"multiline":false,"debounce":250,"expressions":{}},{"name":"emlEmail","type":"user-input","item-type":"email","_auto_id_":"878a1534-25e5-4378-b7cf-d402e1797825","label":"Email","required":false,"expressions":{},"actions":[],"validators":[]},{"name":"rdoWorkForCarillion","type":"choice","item-type":"radio","_auto_id_":"e569c879-5d72-462e-bc3d-e9e4b91613ba","label":"Where are you from:","required":false,"options":[{"label":"Carillion","value":"Carillion"},{"label":"Contractor","value":"Contractor"},{"label":"Public and Others","value":"Public"}],"expressions":{"default":"\"Carillion\""}},{"name":"txtCompany","type":"user-input","item-type":"text","_auto_id_":"d57cff21-d540-4cb4-91ee-050392f79f3c","label":"Contractor Name:","required":false,"multiline":false,"debounce":250,"expressions":{"show":"$store.pages.YourDetails.rdoWorkForCarillion == 'Contractor'"},"actions":[],"validators":[]}],"_auto_id_":"3d66c8df-8f56-4e1a-aa74-ffd6e140d450"},{"name":"nav_footer","type":"area","item-type":"button-bar","_auto_id_":"0444db62-bc1e-4ba3-a5e7-292a79d6f943","content":[{"name":"btnSubmit","type":"button","item-type":"button","_auto_id_":"f7064890-5356-4804-9682-c197db939c71","content":"Save","theme":"default","expressions":{"show":"$store.variables.firstLoad == false"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.pages.YourDetails !== undefined) {\n  var name = cti.store.pages.YourDetails.txtName;\n  var phone = cti.store.pages.YourDetails.txtPhone;\n  var email = cti.store.pages.YourDetails.emlEmail;\n  var workFor = cti.store.pages.YourDetails.rdoWorkForCarillion;\n  var company = cti.store.pages.YourDetails.txtCompany;\n\n  if(((phone === undefined || phone === '') && (email === undefined || email === ''))\n    || (workFor === 'Contractor' && company === undefined)) {\n    document.getElementById('popValidationErr').togglePopup();  \n  }\n  else {  \n    //cti.addDwbToQueueAndProcess(true, phone, email, name);\n    \n    this.$success();\n  }\n}\nelse {\n  document.getElementById('popValidationErr').togglePopup();  \n}"},"_auto_id_":"a516037c-9b00-4e87-98e5-9dc69a74c9fe","actions":[]},{"event":"click","type":"go-to-page","data":{"name":"ReportIncident","isConditional":false},"_auto_id_":"22cbcdfe-cd98-4bd0-b32e-39649a2930c6"}]},{"name":"btnSubmitFirstLoad","type":"button","item-type":"button","_auto_id_":"ed20d3af-f795-49ef-a94e-92f4475d45f3","content":"Save","theme":"default","expressions":{"show":"$store.variables.firstLoad == true"},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"if(cti.store.pages.YourDetails !== undefined) {\n  var name = cti.store.pages.YourDetails.txtName;\n  var phone = cti.store.pages.YourDetails.txtPhone;\n  var email = cti.store.pages.YourDetails.emlEmail;\n  var workFor = cti.store.pages.YourDetails.rdoWorkForCarillion;\n  var company = cti.store.pages.YourDetails.txtCompany;\n\n  if(((phone === undefined || phone === '') && (email === undefined || email === ''))\n    || (workFor === 'Contractor' && company === undefined)) {\n    document.getElementById('popValidationErr').togglePopup();  \n  }\n  else {  \n    //cti.addDwbToQueueAndProcess(true, phone, email, name);\n    cti.store.variables.firstLoad = false;\n    this.$success();\n  }\n}\nelse {\n  document.getElementById('popValidationErr').togglePopup();  \n}"},"_auto_id_":"aa3733d4-98c2-4278-8eb6-9d89103fdd93","actions":[]},{"event":"click","type":"go-to-page","data":{"name":"SelectSite","isConditional":false},"_auto_id_":"53a1feff-b7d5-41a9-a068-73fe24b58873"}]}],"extends":{"type":"area","item-type":"row"},"expressions":{}},{"name":"staticContainer","type":"area","item-type":"static","_auto_id_":"3bcb15cf-4835-4751-9e8e-645061635e68","content":[{"name":"popValidationErr","type":"component","item-type":"web-component","content":[{"name":"htmlValidationErr","type":"content","item-type":"html","_auto_id_":"07d16627-fd3d-46ac-8be7-bcd14ba106fa","content":"<p>Please enter a valid telephone number or email address or contractor name if you're a contractor.</p>","expressions":{}},{"name":"btnValidationOkay","type":"button","item-type":"button","_auto_id_":"8a5c72d2-bae7-4514-99e2-36be8bed3e7f","content":"Okay","theme":"default","left-icon":"fa-check","actions":[{"event":"click","type":"call-function","data":{"name":"togglePopup","params":{"popupId":"popValidationErr"}},"_auto_id_":"ebeecf12-8848-4f40-9927-41957eed33c2"}],"expressions":{}}],"_auto_id_":"d8dda7cf-f566-4a0f-ad94-127d0f2c1bee","attributes":{"id":"popValidationErr"},"expressions":{},"componentId":"44b83127-7dde-471d-a00e-44b3c567df90"},{"name":"popCancelSubmission","type":"component","item-type":"web-component","content":[{"name":"htmlCancelSubmission","type":"content","item-type":"html","_auto_id_":"78d2d461-367a-4d1d-a3ca-25c2ff6c253e","content":"<p>Are you sure you want to cancel entering your details?</p>","expressions":{}},{"name":"btnCancelYes","type":"button","item-type":"button","_auto_id_":"214c41ee-9452-429a-9583-5ba61f468dd4","content":"Yes","theme":"default","left-icon":"fa-check","actions":[{"event":"click","type":"go-back","data":{},"_auto_id_":"eaab6400-da41-407d-b85a-21c27ef88d6e"}],"expressions":{}},{"name":"btnCancelNo","type":"button","item-type":"button","_auto_id_":"420c72bd-8f51-4e36-8e27-4317e1022e2d","content":"No","theme":"default","left-icon":"fa-times","actions":[{"event":"click","type":"call-function","data":{"name":"togglePopup","params":{"popupId":"popCancelSubmission"}},"_auto_id_":"9ae3c432-24ee-4f5c-9c58-21cf3b1f531c"}],"expressions":{},"classes":"cancel"}],"_auto_id_":"3e61acbf-e79d-4aa6-8b30-95b4f02df6db","attributes":{"id":"popCancelSubmission"},"expressions":{},"componentId":"44b83127-7dde-471d-a00e-44b3c567df90"}],"expressions":{}}],"$hover":false},{"name":"Success","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"title","type":"content","item-type":"title","content":"<h1>Success</h1>","_auto_id_":"a20db2fb-cec2-4283-a66a-d9d196c517a2"}],"_auto_id_":"22492341-ddd2-454c-9c49-ecb1814e0306"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"htmlSuccess","type":"content","item-type":"html","_auto_id_":"3965f2d7-a08d-4015-bd9e-fcf8df86bb91","content":"<h2>Thank you for your report!</h2>","expressions":{}},{"name":"htmlNotify","type":"content","item-type":"html","_auto_id_":"853c927b-6067-4876-a7e0-f525e9075cdc","content":"<p>Would you like to hear back when we have closed the life threatening issue you told us about?</p>","expressions":{}},{"name":"btnNotifyYes","type":"button","item-type":"button","_auto_id_":"00a9cefe-5ba0-44ac-9b6c-ac11d1ebd75b","content":"Yes","theme":"default","actions":[{"event":"click","type":"go-to-page","data":{"name":"YourDetails","isConditional":false},"_auto_id_":"219478ad-b0c8-45a0-bbc8-0ac63211bc23"}],"expressions":{}},{"name":"btnNotifyNo","type":"button","item-type":"button","_auto_id_":"900ee8af-928f-4391-ae4f-1221cb42398e","content":"No","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.addDwbToQueueAndProcess(false);\n    \nthis.$success();"},"_auto_id_":"de0382de-56cb-4113-b9bd-e12eea5a76f9"},{"event":"click","type":"go-to-page","data":{"name":"DetailsSuccess","isConditional":false},"_auto_id_":"c6161f92-dc1e-49e4-af35-fdf502418fd0"}]}],"_auto_id_":"7291b3bb-fe49-4e44-a550-0d9b8d654ec9"}],"$hover":false},{"name":"DetailsSuccess","config":[{"name":"Page Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"50b3d72c-bf60-4d6a-9358-96fb67098597","actions":[{"event":"onloaded","type":"inline-function","data":{"sync":true,"code":"setTimeout(function() {\n  cti.utils.callAction('go-to-page', { name: 'SelectSite' });\n}, 5000)"},"_auto_id_":"c587fa91-9d39-4ca6-a150-f97dc34845c1"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"imgCarLogo","type":"media","item-type":"image-viewer","_auto_id_":"75d862f9-d6f9-4ef1-9314-bdb2161c7981","scaleImage":true,"maxWidth":200,"maxHeight":200,"expressions":{},"actions":[],"fileName":"carillion_master_lock_up_colour-notext.png"},{"name":"imgStrapline","type":"media","item-type":"image-viewer","_auto_id_":"5203eba6-9ba8-4dca-9f62-53c6954b7faa","scaleImage":true,"maxWidth":180,"maxHeight":180,"expressions":{},"fileName":"strapline.png","actions":[]}],"_auto_id_":"f45156a5-395d-475b-bb42-081a14b34975"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"htmlDescription","type":"content","item-type":"html","_auto_id_":"0314f343-e632-43ad-8657-c250f62bffb0","content":"<div class=\"yellowBody\">\n  <h2>Don't Walk By</h2>\t\n  <h3>You're all done.</h3>\n  <p>You will shortly be redirected to the start screen.</p>\n</div>","expressions":{}}],"_auto_id_":"3e85b636-b5b3-41fc-afa5-1973c614f8e4","expressions":{}},{"name":"nav_footer","type":"area","item-type":"button-bar","_auto_id_":"1776cdd3-1f2a-45ad-bfa9-e302a4f37ebf","content":[{"name":"imgOneGoal","type":"media","item-type":"image-viewer","_auto_id_":"2910b912-ca29-45a6-8555-bdd7c55e6b50","scaleImage":true,"maxWidth":200,"maxHeight":200,"expressions":{},"fileName":"screen_shot_2016-09-12_at_09.30.32.png"}],"extends":{"type":"area","item-type":"row"},"expressions":{}}],"$hover":false},{"name":"DWBList","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"button","item-type":"button","_auto_id_":"4b71cd4e-f277-413e-aacb-29d9975b555d","content":"","theme":"default","left-icon":"fa-arrow-left","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete window.localStorage['reconciling'];\nthis.$success();"},"_auto_id_":"7cac6af6-52ec-48cd-a534-804b891fb25d"},{"event":"click","type":"go-to-page","data":{"name":"SelectSite","isConditional":false},"_auto_id_":"103f95a2-ce95-4ae3-a604-afa92e36cc53"}]},{"name":"title","type":"content","item-type":"title","content":"<h1>Your DWB's</h1>","_auto_id_":"ececead6-6d85-4f4a-ac34-a1eeb95c7471"},{"name":"btnRefresh","type":"button","item-type":"button","_auto_id_":"08b8d60f-97af-4ecf-afe1-71f5c5d395a4","content":"","theme":"default","left-icon":"fa-refresh","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"localStorage.reconciling = 'true';\n\ndocument.querySelector('#' + cti.store.state.currentPage + ' activity-loader').show();\n\nwindow.commsManager.processQueue();"},"_auto_id_":"df54abdc-3fdd-4bf4-85d0-3b5db0128be1","actions":[]}],"expressions":{}}],"_auto_id_":"76937656-d1eb-4555-ab65-e57c404a3ca9"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"lstDWBs","type":"content","item-type":"list","_auto_id_":"a5d75d75-3340-48c2-9280-55d74ca81cd1","search":"","classes":"","expressions":{},"content":[{"type":"content","item-type":"html","name":"lstDWBs_html","_auto_id_":"fd50aebc-b05d-44ee-b952-1f5c03aacb40","content":"<div class=\"dwbListRow {{$data.$item.serverResponseReceived ? 'ack' : ''}}\">\n  <div class=\"row\">\n    <p><strong>Issue:</strong></p>\n    <p>{{$data.$item.txtWhat}}</p>\n  </div>\n  <div class=\"rowFlex\">\n    <p><strong>Created On:</strong> {{$data.$item.createdOn}}</p>\n    <p><strong>Notify:</strong> {{$data.$item.notify ? true : false}}</p>\n  </div>\n</div>"}],"model":"$store.sentDwbs","dataSource":"dynamic","data":"","listItemClasses":""},{"name":"ldrReconcile","type":"component","item-type":"web-component","content":[],"_auto_id_":"8be202de-e4ef-4cce-a081-f53590e6cc9d","attributes":{},"expressions":{},"componentId":"0e9b4cd0-3972-45ca-a2dc-0e1073bb1625"}],"_auto_id_":"45d3f923-ab2d-407c-b7fa-6a43f5ccd36e","expressions":{}}]},{"name":"PrivacyInformation","config":[],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"button","item-type":"button","_auto_id_":"74a35402-4a57-406a-91d5-c9ddf529cd26","content":"","theme":"default","left-icon":"fa-arrow-left","actions":[{"event":"click","type":"go-back","data":{},"_auto_id_":"04988a7b-858e-402d-b7d4-4ea70ed56cd7"}],"expressions":{}},{"name":"title","type":"content","item-type":"title","content":"<h1>Privacy Information</h1>","_auto_id_":"f30b164d-2c7d-49c7-92b2-c19e2d7d5deb"},{"name":"btnHidden","type":"button","item-type":"button","_auto_id_":"e80e1122-bf5f-48dd-b87f-70229d58bb89","content":"","theme":"default","expressions":{},"classes":"ctHide"}],"_auto_id_":"7de62d57-ad58-4628-a9e1-098b593194c2"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"htmlPrivacy","type":"content","item-type":"html","_auto_id_":"fbd2ecf2-b4d8-4178-a363-cae1b10e0ea4","content":"<p>The personal information you supply, if you choose to supply it, will only be used for reporting purposes on the Don't Walk By reports submitted by users.</p>\n\n<p>Carillion will not sell or give your personal details to any organisation outside of Carillion and it will only be stored on Carillion Cloud Infrastructure.</p>\n\n<p>It may be shared within Carillion to assist with the investigation of Don't Walk By reports and to facilitate reporting.</p>\n\n<p>You can remove your details from the user information page at any time or uncheck the 'Include your details' form field when submitting a Don't Walk By report to restore your anonymity. If you choose to do it individually on the form, you should be aware that your anonymous submission is for that single Don't Walk By report and your details will be included on any subsequent submission (if you check the 'Include your details' question).</p>\n\n<p>Carillion PLC is the data controller for the Don't Walk By application and data submitted through it.</p>","expressions":{}}],"_auto_id_":"4b5799be-4665-456a-af36-c49dbf656524"}]},{"start":false,"name":"xCallbackLanding","config":[{"name":"Page Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"85b37d0b-a4e8-4c3a-b40f-3a18bf5d7301","actions":[{"event":"onloaded","type":"call-actionflow","data":{"name":"xCallBackFlow"},"_auto_id_":"77a5ca14-e87f-4396-ac96-3fba97c2e5c9"}]}],"content":[{"name":"title_bar","type":"area","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"title","type":"content","item-type":"title","content":"<h1>Contract Lookup</h1>","_auto_id_":"9f2b97f1-4239-458c-b8b6-366c22513d6f"}],"_auto_id_":"953ee077-3593-4997-afc9-49e0072a3c59"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"lstSites","type":"content","item-type":"list","_auto_id_":"dee8571d-a279-43d0-83ea-69b9147b7cdf","search":"","classes":"","expressions":{},"model":"$store.telentSites","actions":[{"event":"click","type":"call-function","data":{"name":"chooseSiteFromList","params":{"siteName":"{{$data.$item.SiteName}}"}},"_auto_id_":"f281d3b5-40b7-42b3-a106-c1723cd75ee5"}],"dataSource":"dynamic","data":"","listItemClasses":"","content":[{"type":"content","item-type":"html","name":"lstSites_html","_auto_id_":"1693a4fd-7a9f-45f4-bf7c-a7efa29c0424","content":"<div class=\"listView {{$data.$item.selected ? 'selected' : ''}}\">\n  <p>{{$data.$item.SiteName}}</p>\n</div>"}]}],"_auto_id_":"8d467f99-2e77-404e-be0d-50145aaca8dc","expressions":{}},{"name":"nav_footer","type":"area","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnNext","type":"button","item-type":"button","_auto_id_":"36fc7317-27c1-40e6-a81b-d34cde1def08","content":"Next","theme":"default","expressions":{"show":"1 === 2"},"actions":[{"event":"click","type":"go-to-page","data":{"name":"ReportIncident","isConditional":false},"_auto_id_":"ca1abe8c-37b2-4e7a-b83c-cd0a2cc361ed"}]}],"_auto_id_":"f1e154dd-ba15-4d79-b879-80c5b4aeb8c7","expressions":{}},{"name":"staticContainer","type":"area","item-type":"static","_auto_id_":"9fe5f8ef-7a98-41c9-814f-dc3ac1497cb0","content":[{"name":"ldrCallback","type":"component","item-type":"web-component","content":[],"componentId":"0e9b4cd0-3972-45ca-a2dc-0e1073bb1625","_auto_id_":"8261776f-a66c-4b2a-be2f-720346318a14","attributes":{},"expressions":{}},{"name":"popCallbackError","type":"component","item-type":"web-component","content":[{"name":"htmlCallbackError","type":"content","item-type":"html","_auto_id_":"4800aa47-7c15-4211-970a-bae8c046fba9","content":"<p>There has been an error downloading data. Please try again later ensuring you have a sufficient data connection.</p>","expressions":{}},{"name":"btnErrorOkay","type":"button","item-type":"button","_auto_id_":"ac63e2c3-0f74-4679-80e9-19b56cb5ba0f","content":"Try Again","theme":"default","left-icon":"fa-refresh","expressions":{},"actions":[{"event":"click","type":"call-function","data":{"name":"togglePopup","params":{"popupId":"popCallbackError"}},"_auto_id_":"7d667aed-d982-45ce-b0d6-e0dbc0e40bd4"},{"event":"click","type":"call-actionflow","data":{"name":"xCallBackFlow"},"_auto_id_":"a77268d2-8186-407f-8c22-570aaa30ba42"}]}],"componentId":"44b83127-7dde-471d-a00e-44b3c567df90","_auto_id_":"7ab7c1b0-d546-4b13-afdb-55cfa6a5488f","attributes":{"id":"popCallbackError"},"expressions":{}},{"name":"popSiteNotFound","type":"component","item-type":"web-component","content":[{"name":"htmlSiteNotFound","type":"content","item-type":"html","_auto_id_":"d3135f34-f9a3-4d10-8227-43b78e308a3f","content":"<p>We could not find your contractor. Please select from the list to continue.</p>","expressions":{}},{"name":"btnSiteNotFoundOkay","type":"button","item-type":"button","_auto_id_":"9acb8172-65aa-4bbb-87e2-9be817345cde","content":"Okay","theme":"default","left-icon":"fa-check","expressions":{},"actions":[{"event":"click","type":"call-function","data":{"name":"togglePopup","params":{"popupId":"popSiteNotFound"}},"_auto_id_":"8d4ff165-600d-4368-81a1-4968037df05c"}]}],"componentId":"44b83127-7dde-471d-a00e-44b3c567df90","_auto_id_":"ac9cc771-a919-4117-89a0-d36587b9db4d","attributes":{"id":"popSiteNotFound"},"expressions":{},"actions":[]}],"expressions":{}}]}],"actionflows":[{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.selectedLocation;\ndelete cti.store.currentPosition;\ndelete cti.store.invoked;\n\nvar footer = document.getElementById('nav_footer');\n//footer.removeAttribute('class');\n\nif(footer.className.indexOf('highlight') > -1) {\n  footer.className = footer.className.replace(' highlight', '');\n}\n\nvar next = this.$success;\n\nvar d = document.getElementsByTagName('activity-loader')[0];\n\nif(d === undefined) {\n  console.log('Activity loader not ready');\n}\nelse {\n  d.updateText('Getting GPS...');\n  d.show();\n}\n\nvar dataConnection = true;\n\nif(cti.store.env.platform.type !== 'desktop') {\n  var conn = navigator.network.connection.type\n  \n  if(conn === Connection.NONE || conn === Connection.UNKNOWN || conn === Connection.CELL) {\n  \tdataConnection = false;\n  }\n}\n\nif(dataConnection) {\n  console.log('Attempting to get device location');\n  \n  window.navigator.geolocation.getCurrentPosition(function(r) { \n    console.log('SUCCESS'); \n    console.log(r); \n    \n    cti.store.currentPosition = {\n      latitude: r.coords.latitude,\n      longitude: r.coords.longitude\n    };\n    \n    cti.store.devicePosition = {\n      latitude: r.coords.latitude, \n      longitude:r.coords.longitude\n    };\n    \n    var d = document.getElementsByTagName('activity-loader')[0];\n    d.updateText('Getting Contracts...');\n    \n    next();\n  }, \n  function(e) { \n    console.log('ERROR: %s', e);\n    cti.store.currentPosition = null;\n    \n    if(cti.store.env.platform.type !== 'desktop') {\n      document.getElementById('popGPSError').togglePopup();\n    }\n    else {\n      var d = document.getElementsByTagName('activity-loader')[0];\n      d.updateText('Getting Contracts...');\n      \n      next();\n    }\n  },\n  {\n    timeout: 15000\n  }); \n}\nelse {\n  if(d !== undefined) {\n    document.getElementsByTagName('activity-loader')[0].hide();\n  }\n  \n  document.getElementById('popErr').togglePopup();\n}"},"_auto_id_":"bbfea57b-8792-4b5d-92a5-1095df810527"},{"event":"click","type":"call-azure-app-service","data":{"name":"dwbService","operation":"getSites","params":{"lat":"{{$store.currentPosition.latitude}}","lng":"{{$store.currentPosition.longitude}}","currentGuid":"{{store.currentSitesGuid}}"}},"_auto_id_":"d4e2d38d-e87e-49fd-a3eb-8ea8e15f1cbb","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"function markerEvent(e) {\n  cti.chooseSiteFromList(this.title, this.position.lat(), this.position.lng(), this.id);\n}\n\nfunction plotPointsOnMap(sites) {\n  var autoCompleteStrings = [];\n  var markers = [];\n  var currentSitesOnMap = [];\n  var counter = 0;\n\n  if(sites !== undefined && sites.length > 0) {\n    for(var i = 0; i < sites.length; i++) {\n      var loc = sites[i];\n\n      //if(window.currentCentrePosition)\n\n      loc.distance = geolib.getDistance(\n        { latitude: cti.store.currentPosition.latitude, longitude: cti.store.currentPosition.longitude },\n        { latitude: loc.Latitude, longitude: loc.Longitude }\n      );\n      \n      autoCompleteStrings.push(loc.SiteName);\n    }\n\n    cti.store.currentSites = cti.store.currentSites.sort(function(a, b) {\n      return a.distance - b.distance;\n    });\n\n    for(var t = 0; t < 51; t++) {\n      if(cti.store.currentSites[t] !== undefined) {\n        var site = cti.store.currentSites[t];\n\n        if(isPointInUserRadius(site)) {\n          try {\n            var contractSites = JSON.parse(site.SiteLocations);\n\n            if(contractSites !== null) {\n              counter = counter + 1;\n\n              for(var l = 0; l < contractSites.length; l++) {\n                var latLng = new google.maps.LatLng(contractSites[l].latitude, contractSites[l].longitude);\n\n                var marker = new google.maps.Marker({\n                  label: counter.toString(),\n                  position: latLng,\n                  title: site.SiteName,\n                  id: contractSites[l].id\n                });\n\n                markers.push(marker);\n                marker.setMap(map);\n                marker.addListener('click', markerEvent);\n                \n              }\n\n              site.counter = counter;\n              currentSitesOnMap.push(site);\n            }\n          }\n          catch(ex) {\n            console.log(ex);\n          }\n        }\n        else {\n          break;\n        }\n      }\n      else {\n        break;\n      }\n    }\n  }\n\n  cti.store.currentSitesOnMap = currentSitesOnMap;\n  window.currentMarkers = markers;\n  cti.store.autoCompleteStrings = autoCompleteStrings;\n}\n\n\nfunction isPointInUserRadius(point) {\n  var lat = cti.store.currentPosition.latitude;\n  var lon = cti.store.currentPosition.longitude;\n\n  return geolib.isPointInCircle(\n    { latitude: point.Latitude, longitude: point.Longitude },\n    { latitude: lat, longitude: lon },\n    25000\n  );\n}\n\nfunction mapDragStartEvent() {\n  clearTimeout(window.dragTimeout);\n}\n\nfunction mapDragEndEvent() {\n  window.currentCentrePosition = map.getCenter();\n\n  cti.store.currentPosition.latitude = window.currentCentrePosition.lat();\n  cti.store.currentPosition.longitude = window.currentCentrePosition.lng();\n\n  window.dragTimeout = setTimeout(function() {\n    for(var i = 0; i < window.currentMarkers.length; i++) {\n      window.currentMarkers[i].setMap(null);\n    }\n\n    plotPointsOnMap(cti.store.currentSites);\n    cti.utils.updatePage();\n    console.log('Updated displayed map markers');\n  }, 1000)\n\n  //console.log('Drag end complete');\n}\n\nif(cti.store.currentPosition === null) {\n  cti.store.currentPosition = {\n    latitude: 52.91228,\n    longitude: -1.4523437\n  }\n}\n\nvar map = new google.maps.Map(document.getElementById('map'), {\n  center: { lat: cti.store.currentPosition.latitude, lng: cti.store.currentPosition.longitude },\n  zoom: 15,\n  disableDefaultUI: true,\n  streetViewControl: false\n});\n\nmap.addListener('dragstart', mapDragStartEvent);\nmap.addListener('dragend', mapDragEndEvent);\n\nif(cti.store.devicePosition !== undefined) {\n  var latLng = new google.maps.LatLng(cti.store.devicePosition.latitude, cti.store.devicePosition.longitude);\n\n  var selfMarker = new google.maps.Marker({\n    icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',\n    position: latLng,\n  });\n\n  selfMarker.setMap(map);\n}\n\nvar results = cti.store.azureAppServices.dwbService.getSites;\n\nif(results.res === undefined) {\n  cti.store.currentSites = results.sites;\n  cti.store.currentSitesGuid = results.guid;\n\n  plotPointsOnMap(cti.store.currentSites);\n}\nelse {\n  plotPointsOnMap(cti.store.currentSites);\n}\n\nthis.$success();"},"_auto_id_":"e9410361-bb4c-42a1-b8bf-d9a51d057286","actions":[]},{"event":"success","type":"call-function","data":{"name":"hideLoader"},"_auto_id_":"1b6e1368-fa1e-4b73-a972-d6553c26e181"},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"console.log('Failed to load map');\ndocument.getElementsByTagName('activity-loader')[0].hide();\ndocument.getElementById('popErr').togglePopup();"},"_auto_id_":"c5a3331b-6f64-4f30-89b4-a1672fbf7ce9"}]}],"name":"LoadMap","$hover":false},{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"delete cti.store.selectedSite;\ndelete cti.store.telentSites;\n\nvar ldr = document.getElementsByTagName('activity-loader')[0];\nldr.updateText('Getting contracts...');\nldr.show();\n\n$success();"},"_auto_id_":"c26e76d0-3def-42dc-a4b2-a9732a6558af"},{"event":"click","type":"call-azure-app-service","data":{"name":"dwbService","operation":"getSites","params":{"currentGuid":""}},"_auto_id_":"4a3d881a-209f-4bac-af8d-f645b8d3eaa4","actions":[{"event":"success","type":"inline-function","data":{"sync":true,"code":"var results = cti.store.azureAppServices.dwbService.getSites;\nif(results.res === undefined) {\n  cti.store.currentSites = results.sites;\n  cti.store.currentSitesGuid = results.guid;\n}\n\nvar suppliedSubcontractor = null;\n\nif(cti.store.invoked !== undefined ){\n   suppliedSubcontractor = cti.store.invoked.subcontractor.toLowerCase();\n}\n\nvar telentSites = [];\nvar suppliedSite = null;\n\nfor(var i = 0; i < cti.store.currentSites.length; i++) {\n  var site = cti.store.currentSites[i];\n\n  if(site.BusinessGroup === 'Carillion Telent') {\n    telentSites.push(site);  \n  }\n\n  if(site.SiteName.toLowerCase() === suppliedSubcontractor) {\n    suppliedSite = site;\n  }\n}\n\ncti.store.telentSites = telentSites.sort(function(a, b) {\n  if(a.SiteName.toLowerCase() < b.SiteName.toLowerCase()) return -1;\n  if(a.SiteName.toLowerCase() > b.SiteName.toLowerCase()) return 1;\n  return 0;\n});\n\nif(suppliedSite) {\n  cti.chooseSiteFromList(suppliedSite.SiteName);\n  cti.utils.callAction('go-to-page', { name: 'ReportIncident' });\n}\nelse {\n  document.getElementsByTagName('activity-loader')[0].hide();\n  cti.togglePopup('popSiteNotFound');\n}"},"_auto_id_":"06f01c6c-d10b-48b6-8f03-bc97469363f1","actions":[]},{"event":"fail","type":"inline-function","data":{"sync":true,"code":"console.log('Failed to load sites');\ndocument.getElementsByTagName('activity-loader')[0].hide();\ndocument.getElementById('popCallbackError').togglePopup();"},"_auto_id_":"8f79b491-aa5d-4f2e-bf57-446a4655023e","actions":[]}]}],"name":"xCallBackFlow"}],"dataflows":[{"content":[],"name":"Flow1"}],"config":[{"name":"css_asset_1","type":"style","item-type":"css-asset","_auto_id_":"b2a02a33-d4c3-4be0-81cd-79a99c0cdb54","fileName":"dwbLite.css"},{"name":"dwbService","type":"integration","item-type":"azure-app-services","_auto_id_":"0d9f1b4c-9bb2-44bd-83fa-8d8d91c3da62","headers":{},"params":[],"operations":[{"ttlMinutes":0,"name":"getSites","summary":"Gets sites from db","path":"getSites","method":"GET","params":[{"name":"currentGuid","description":"Current Guid","type":"string","typeConfig":{}}],"$open":true},{"ttlMinutes":0,"name":"saveDwb","path":"saveDwb","summary":"Sends DWB","method":"POST","$open":false,"params":[{"name":"payload","description":"Message payload","type":"string","typeConfig":{}}]},{"ttlMinutes":0,"name":"sendDwbPhoto","summary":"sendDwbPhoto","path":"sendDwbPhoto","method":"POST","params":[{"name":"photoRef","description":"photoRef","type":"fileref","typeConfig":{}},{"name":"payload","description":"payload","type":"string","typeConfig":{}}],"$open":true}],"aasUrl":"https://dwblite-app-service-dev.azurewebsites.net/"},{"name":"matchTypeWithSite","type":"scripting","item-type":"function","_auto_id_":"fa9ce023-0e77-4817-bd19-f3f716f8eefd","sync":true,"params":[]},{"name":"chooseSiteFromList","type":"scripting","item-type":"function","_auto_id_":"1c90cd1f-832f-4d8a-813d-063b90b15b98","sync":true,"params":[{"name":"siteName","required":true},{"name":"lat"},{"name":"lng"},{"name":"id"}],"content":"var allSites = cti.store.currentSites;\nvar site;\n\nfor(var i = 0; i < allSites.length; i++) {\n  delete allSites[i].selected;\n  delete allSites[i].selectedLocation\n  \n  if(allSites[i].SiteName === siteName) {\n  \tallSites[i].selected = true;\n    site = allSites[i];\n  }\n}\n\nvar locs = JSON.parse(site.SiteLocations);\n\nsite.selected = true;\nsite.selectedLocation = {\n    name: site.SiteName,\n\tlatitude: lat || locs[0].latitude,\n    longitude: lng || locs[0].longitude,\n    id: id  || locs[0].id,\n    primaryId: site.Id\n}\ncti.store.selectedLocation = site.selectedLocation;\n\nif(cti.store.invoked) {\n  cti.store.invoked.subcontractor = site.SiteName;\n}\n\nif(site.BusinessGroup === 'Carillion Telent' && cti.store.state.currentPage !== 'xCallbackLanding') {\n  cti.togglePopup('popTelentSiteSelected')\n}\nelse {\n  var footer = document.getElementById('nav_footer');\n  footer.className += ' highlight';\n  $('div#btnNext').removeClass('ng-hide');\n  cti.utils.updatePage();\n}","actions":[]},{"name":"completeReport","type":"scripting","item-type":"function","_auto_id_":"265670fd-7325-4011-b6f7-4ac6c4e165d0","sync":true,"params":[{"name":"addAnother"}],"content":"var pageContent = cti.store.schema.pages[2].content[1].content;\nvar questions = [];\n\nfor(var i = 0; i < pageContent.length; i++) {\n    var item = pageContent[i];\n\n    if((item.type === 'user-input' || item.type === 'choice') && (item.name !== 'tpDwbPhoto' && item.name !== 'chkIncludeDetails')) {\n        questions.push(item);\n    }\n}\n\nvar result = {};\nvar currPage = cti.store.pages.ReportIncident;\n//currPage.txtActions = null;\nvar errors = [];\n\nfor(var i = 0; i < questions.length; i++) {\n  var q = questions[i];\n  \n  if(q.name === 'txtActions' || currPage[q.name] !== undefined) {\n    result[q.name] = currPage[q.name] || null;\n  }\n  else {\n    errors.push(q.label);\n  }\n}\n\nif(errors.length > 0) {\n  cti.store.submissionErrors = errors;\n  document.getElementById('popFormErrors').togglePopup();\n}\nelse {\n  if(cti.store.pendingDwbSubmissions === undefined) {\n    cti.store.pendingDwbSubmissions = [];\n  }\n  \n  result.createdOn = moment().format('YYYY-MM-DD HH:mm:ss');\n  result.serverResponseReceived = false;\n  result.site = cti.store.selectedLocation;\n  result.locationOfIssue = currPage['txtLocation'];\n  \n  if(cti.store.devicePosition !== undefined) {\n    result.devicePosition = cti.store.devicePosition; \n  }\n  \n  // Attach contact details if selected\n  if(cti.store.pages.ReportIncident.chkIncludeDetails !== undefined) {\n  \tif(cti.store.pages.ReportIncident.chkIncludeDetails.includeDetails === true && cti.store.pages.YourDetails !== undefined) {\n      result.notify = true;\n      result.notifyDetails = {\n        phone: cti.store.pages.YourDetails.txtPhone,\n        email: cti.store.pages.YourDetails.emlEmail,\n        name: cti.store.pages.YourDetails.txtName,\n        workForCarillion: cti.store.pages.YourDetails.rdoWorkForCarillion,\n        company: cti.store.pages.YourDetails.txtCompany\n      }\n    }\n  }\n\n  // Attach photo\n  if(cti.store.media.sendDwbPhoto !== undefined)\n    result.photoRef = cti.store.media.sendDwbPhoto.images[cti.store.media.sendDwbPhoto.images.length - 1];\n  \n  // Check if this form has been invoked\n  if(cti.store.invoked) {\n    // CLONE the invoked object\n    result.invoked = JSON.parse(JSON.stringify(cti.store.invoked));\n  }\n  \n  cti.store.pendingDwbSubmissions.push(result);\n  \n  delete cti.store.pages.ReportIncident;\n  delete cti.store.media.sendDwbPhoto;\n  \n  cti.addDwbToQueueAndProcess();\n  \n  if(addAnother) {\n  \tcti.utils.callAction('go-to-page', { name: 'SelectSite' });\n  }\n  else {\n    cti.utils.callAction('go-to-page', { name: 'DetailsSuccess' });\n  }\n}"},{"name":"addDwbToQueueAndProcess","type":"scripting","item-type":"function","_auto_id_":"fce52b3a-b5c9-4059-a206-eefa98c8b148","sync":true,"params":[{"name":"notify","default":"","required":false},{"name":"phone","required":false},{"name":"email"},{"name":"name"}],"content":"if(cti.store.sentDwbs === undefined) {\n  cti.store.sentDwbs = [];\n}\n\nvar i = cti.store.pendingDwbSubmissions.length;\nvar pending = cti.store.pendingDwbSubmissions;\n\nwhile(i--) {\n  var sub = cti.store.pendingDwbSubmissions[0];\n  \n  if(sub.photoRef !== undefined) {\n    var containerName = moment().format('YYYYMMDD');\n    var photoName = window.commsManager.generateUUID();\n\n    sub.containerName = containerName;\n    sub.photoName = photoName;\n    \n  \tvar photoMsg = {\n    \tendpoint: 'sendDwbPhoto',\n        payload: {\n          photoRef: sub.photoRef,\n          photoName: photoName,\n          containerName: containerName\n        }\n    }\n    \n    window.commsManager.addToQueue(photoMsg);\n  }\n  \n  var msg = {\n    endpoint: 'saveDwb',\n    payload: sub\n  }\n\n  var id = window.commsManager.addToQueue(msg);\n  cti.store.sentDwbs.push(sub);\n  pending.splice(0, 1);\n  cti.store.pendingDwbSubmissions = pending;\n}\n\nwindow.commsManager.processQueue();","actions":[]},{"name":"showLoader","type":"scripting","item-type":"function","_auto_id_":"f89fb639-40b7-43e5-a29a-450d938c5139","sync":true,"params":[],"content":"document.querySelector('#' + cti.store.state.currentPage + ' activity-loader').show();\n$success();"},{"name":"hideLoader","type":"scripting","item-type":"function","_auto_id_":"ddc8e79e-577a-49e8-b50a-68409e89d302","sync":true,"params":[],"actions":[],"content":"document.querySelector('#' + cti.store.state.currentPage + ' activity-loader').hide();"},{"name":"togglePopup","type":"scripting","item-type":"function","_auto_id_":"e5064019-d20b-4790-9de2-0b5bbb3bf1bd","sync":true,"params":[{"name":"popupId"}],"content":"//var popup = document.getElementById(popupId);\nvar popup = document.querySelector('#' + popupId)\npopup.togglePopup();"},{"name":"js_asset_2","type":"scripting","item-type":"js-asset","_auto_id_":"74d7b3da-c095-42ae-874c-b1ee842977d4","fileName":"awesomplete.min.js"},{"name":"css_asset_2","type":"style","item-type":"css-asset","_auto_id_":"3e664b1e-f387-49b5-8e2d-93189b846658","fileName":"awesomplete.css"},{"name":"App Load Event","type":"event","item-type":"onload","_auto_id_":"d2f02a80-a520-47e4-a00d-d8808be4ee5a","actions":[{"event":"onload","type":"inline-function","data":{"sync":true,"code":"var apiKey = cti.store.schema.metadata.googleMapsApiKey;\nvar googleMaps = document.createElement('script');\ngoogleMaps.src = 'https://maps.googleapis.com/maps/api/js?key=' + apiKey;\n\ndocument.body.appendChild(googleMaps);\n\nsetTimeout(function() {\n  window.commsManager = new CommsManager();\n}, 5000);"},"_auto_id_":"de204aea-d450-496e-8ef3-17d252b2ea28"}]},{"name":"js_asset_3","type":"scripting","item-type":"js-asset","_auto_id_":"97dc7062-00f5-452f-ad6c-a387b7e27f6a","fileName":"moment 5.js"},{"name":"js_asset_4","type":"scripting","item-type":"js-asset","_auto_id_":"cad8cc92-3344-4dba-b162-1ecf81b92e3b","fileName":"dwbCommsManager.js"},{"name":"js_asset_5","type":"scripting","item-type":"js-asset","_auto_id_":"dbf1b144-668d-42e6-af0c-46480ebe375a","fileName":"geolib.min.js"},{"name":"image_asset_1","type":"style","item-type":"image-asset","_auto_id_":"be4f1a74-2b40-48f5-911e-b5f782008120","fileName":"carillion_master_lock_up_colour.png"},{"name":"image_asset_2","type":"style","item-type":"image-asset","_auto_id_":"bda9a4a2-9f84-4634-b079-1098d2a951a3","fileName":"greenLogo.png"},{"name":"image_asset_3","type":"style","item-type":"image-asset","_auto_id_":"112ad996-a18d-415e-aeb4-3de377e50585","fileName":"screen_shot_2016-09-12_at_09.30.32.png"},{"name":"image_asset_4","type":"style","item-type":"image-asset","_auto_id_":"07dfd205-1ff1-4905-aeda-64172fe2696e","fileName":"strapline.png"}],"components":[{"name":"CTAutoCompleteSearch","description":"","icon":"fa-search-plus","tagName":"ct-autocomplete-search","type":"web-component","format":"javascript","annotations":{"attributes":[{"name":"listSource","description":"","type":"string","enum":null,"required":true}]},"_auto_id_":"a5471e48-8588-4587-8105-51e434127585","valid":true,"files":{"original":"CTAutoCompleteSearch.js","transpiled":"CTAutoCompleteSearch.output.js"},"typeVersion":"1","userConfig":{}},{"name":"CTActivityLoader","description":"","icon":"fa-hourglass-half","tagName":"activity-loader","type":"web-component","format":"javascript","annotations":{},"_auto_id_":"0e9b4cd0-3972-45ca-a2dc-0e1073bb1625","valid":true,"files":{"original":"CTActivityLoader.js","transpiled":"CTActivityLoader.output.js"},"typeVersion":"1","userConfig":{}},{"name":"CTPopup","description":"","icon":"fa-external-link","tagName":"ct-popup-box","type":"web-component","format":"javascript","annotations":{"attributes":[{"name":"id","description":"","type":"string","enum":null,"required":true}],"functions":[{"name":"togglePopup","description":"Toggles the menu opened and closed based on the value\nof the this.opened property (initially set to false)","params":[],"returnType":"void","returnEnum":null}]},"_auto_id_":"44b83127-7dde-471d-a00e-44b3c567df90","valid":true,"files":{"original":"CTPopup.js","transpiled":"CTPopup.output.js"},"typeVersion":"1","userConfig":{}}],"$hover":false,"lastSchemaUpgradeDate":"DOWNGRADED_MANUALLY_FROM_24_TO_22_BY_KEVIN_PAXTON","icondata":"dwblite.png","minimumStudioVersion":"3.1.0","id":"0f9fea7d-5a97-4346-8a80-651e734c9cc2","packageId":"com.commontime.infinity.DWBLite","jwt":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBfaWQiOiIwZjlmZWE3ZC01YTk3LTQzNDYtOGE4MC02NTFlNzM0YzljYzIiLCJhcHBfbmFtZSI6IkRXQkxpdGUiLCJidWlsZF9pZCI6IjViYTY5OWI2LThlNzUtNGM1NS1iZTAyLWU2NTcxMzM0Y2I2MiIsImNsaWVudF9pZCI6ImYwMTQ4ODE3LTlkZjYtNDhjYi1hYzU2LTAyYTNkMDU1Mjg5OCIsImNsaWVudF9zZWNyZXQiOiJXamR6V0hGT1RXRnFXREpNYURKNE9FWnVSRzkxWnowOSIsImV4cCI6MTUyMDU1MzYwMCwiZnJlcXVlbmN5IjoyMTYwMDAwMDAsImhhc2giOiJkMDJhNjBjNWY5MWY1NzQ0ODNlMWI3YjY0MTY3Y2NjYTk2MjFmZDFmY2FlZjM5MjUyYmEwNDJhNzRjZDBlZTdlIiwibGljX2V4cCI6MTUxNzk2MTYwMCwibHBfaWQiOiIzMjc1OTEwMC1hNTEzLTRmNzQtODdiNy1iOGFmMDk5ODZmNzMiLCJwYWNrYWdlX2lkIjoiY29tLmNvbW1vbnRpbWUuaW5maW5pdHkuRFdCTGl0ZSIsInJlZnJlc2hfdG9rZW4iOiJaSGxUVEdGQ1Z6bFVUMWQzUTJ0U2MzQlBhRUVyVUhWNVZXTnhUREY2TDB0bFNXcFZZME5DWlRKVFVUMD0iLCJ0eXBlIjoiZnVsbCIsImlhdCI6MTUwNzYzOTI5NH0.nK7nAkeTIGEeW61BZShFx8_Iec7rY1UQwyu1e-j-YwRIp0s3e503qQqwfjNGnRtHFIaz3gZN3K9Ys00rF5Ctk0bUsnt-hgeU7w47LcngjryXqsMvjKT_ccfVylgypecJ3UeNrIS3xnLdGHdHq9mkCRr3CyXY3bwD6xRLG8eOHDprVRWeep57Svo1aUo6iE0irQJswGbon-j-WfuzGmBzBnxfTGs09j-y6H1t1Ary6Z8CF2rVMAU_WnSiBIqAy4Of5A8MzFF8PbNKlPonsW8J9YZw-Zb7KVH92Si6BgcqI5FRWyPwW-CdqPU_pDHicgfcg8nGWVcRSI-_fNDsbNv-MQ","buildId":"5ba699b6-8e75-4c55-be02-e6571334cb62","hostContext":0}